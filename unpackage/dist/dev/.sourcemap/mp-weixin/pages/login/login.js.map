{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/44553/Desktop/微信图片视频/备份代码/66_Chargingpile_applet_2.0/pages/login/login.vue?5669","webpack:///C:/Users/44553/Desktop/微信图片视频/备份代码/66_Chargingpile_applet_2.0/pages/login/login.vue?ea61","webpack:///C:/Users/44553/Desktop/微信图片视频/备份代码/66_Chargingpile_applet_2.0/pages/login/login.vue?4ff5","webpack:///C:/Users/44553/Desktop/微信图片视频/备份代码/66_Chargingpile_applet_2.0/pages/login/login.vue?dda8","uni-app:///pages/login/login.vue","webpack:///C:/Users/44553/Desktop/微信图片视频/备份代码/66_Chargingpile_applet_2.0/pages/login/login.vue?dd53","webpack:///C:/Users/44553/Desktop/微信图片视频/备份代码/66_Chargingpile_applet_2.0/pages/login/login.vue?9886"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","oplist","$imgUrl","submitToggle","isXieyi","isGetMobile","loginCode","showFollowGuide","qrCodeUrl","accountName","debugReason","option","onLoad","app","console","setTimeout","methods","getLoginCode","uni","success","that","handleOpenPrivacyContract","login","code","onGetPhoneNumber","mcode","doLogin","deviceId","then","res","posterList","catch","logoshow","_this","list","loginOk","device","port","processedPort","url","fail","delta","pad","num","len","mbid","appid","moban","Toast","getConfig","token","guangao","projectId","showFollowGuidePopup","onTapQR","title","icon","duration","closeFollowGuide","onOverlayTap","triggerPhoneAuth"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACsC;;;AAG1F;AACoM;AACpM,gBAAgB,yMAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACdA;AAAA;AAAA;AAAA;AAA0vB,CAAgB,2vBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;AC2D9wB;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAGA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;EACAC;IAAA;IACA;IACA;;IAEA;IACA;MACA;MACA;QACA;MACA;MACA;MAAA,KACA;QACA;QACA;MACA;MACA;MAAA,KACA;QACA;QACA;UACA;UACA;YACA;YACA;YACAC;UACA;YACA;UACA;QACA;UACA;QACA;MACA;IACA;MACA;IACA;IAEAC;IAEA;IACA;;IAEA;IACA;MACA;MACAA;MACA;QACAA;QACA;QACAC;UACA;QACA;MACA;QACAD;QACA;MACA;IACA;EACA;;EACAE;IACAC;MACA;MACAC;QACAC;UACAC;QACA;MACA;IACA;IACAC;MACA;MACAH;IACA;IACAI;MACA;QACA;MACA;;MAEA;MACA;QACA;MACA;MAEA;QACAC;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;;MAEA;MACA;QACA;MACA;;MAEA;MACA;QACA;MACA;MAEA;QACAD;QACAE;MACA;MACA;IACA;IACAC;MAAA;MACA;MACA;MACAZ;;MAEA;MACA;;MAEA;MACA;QACA;QACA;QACA;QAEA;UACA;UACAa;UACAb;QACA;UACA;UACAa;UACAb;QACA;MACA;;MAEA;;MAEA;MACA;QACAd;QACAc;MACA;QACAA;MACA;MAEAA;;MAEA;MACA,mDACAc;QACAC;QACA;UACAf;UACAI;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACA;UACAA;UACA;UACAA;UACA;YACA;YACA;cACAY;YACA;YACAZ;UACA;YACA;YACAA;UACA;;UAEA;UACA;UACA;UACA;QACA;UACAJ;UACA;UACA;UACA;UACA;QACA;UACAA;UACA;UACA;UACA;UACA;UACA;UACA;QACA;UACAA;UACA;UACA;UACA;UACA;QACA;MACA,GACAiB;QACAjB;QACA;QACA;QACA;MACA;IACA;IACAkB;MAAA;MACA;MACA;QACA;QACA;QACA;MACA;MAEA;MACA;MACAd;MACAe,2CACAL;QACA;UACA;UACA;YACAM;YACAA;YACAhB;UACA;QACA;UACAe;QACA;QACA;QACA;MACA,GACAF;QACAjB;QACA;QACA;MACA;IACA;IACAqB;MACArB;;MAEA;MACA;;MAEA;MACA;QACAA;;QAEA;QACA;QACA;QAEA;QACA;QAEA;UACA;UACAsB;UACAC;UACAvB;QACA;UACA;UACAsB;UACAC;UACAvB;QACA;;QAEA;QACA;QACA;UACA;YACAwB;UACA;YACAxB;YACAwB;UACA;QACA;UACAA;QACA;;QAEA;QACA;UACAxB;;UAEA;UACA;UACA;YACAA;YACA;YACAI;cACAqB;cACApB;gBACAL;gBACA;gBACAC;kBACAG;oBACAqB,8EACA;oBACApB;sBACAL;oBACA;oBACA0B;sBACA1B;oBACA;kBACA;gBACA;cACA;cACA0B;gBACA1B;gBACA;gBACAI;kBACAqB,8EACA;gBACA;cACA;YACA;UACA;YACAzB;YACA;YACAI;cACAuB;cACAtB;gBACAL;cACA;cACA0B;gBACA1B;gBACA;gBACAI;kBACAqB,8EACA;gBACA;cACA;YACA;UACA;UACA;QACA;MACA;;MAEA;MACA;MACAzB;;MAEA;MACA;QACAI;UACAqB;QACA;QACA;MACA;MAEA;QACArB;UACAqB;QACA;QACA;MACA;MAEA;QACArB;UACAqB;QACA;QACA;MACA;;MAEA;MACA;QACArB;UACAqB;QACA;MACA;QACA;QACArB;UACAqB;QACA;MACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IAEA;IACA;IACA;IAEA;IACAG;MACA;MACA;QACAC;QACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;QACAC;MACA;MACA,mDACAlB;QACA;UACA;UACA;YACA;cACAmB;YACA;cACAA;YACA;cACAA;YACA;cACAA;YACA;cACAA;YACA;UACA;UACA7B;QACA;UACA8B;QACA;MACA,yBAEA;IACA;IACA;IACAC;MACA;QACAC;MACA;MACA;QACA;UACAhC;UACAA;QACA;UACA;QAAA;MAEA,yBAEA;IACA;IACA;IACAiC;MACA;QACAC;MACA;MACA;QACA;UACAlC;QACA;UACAA;UACA;QACA;MACA,yBAEA;IACA;IAEA;IACAmC;MACAvC;MACAA;;MAEA;MACA;QACA;QACAA;MACA;QACAA;QACA;QACA;MACA;;MAEA;MACA;QACA;QACAA;MACA;QACAA;QACA;MACA;;MAEA;MACA;MACAA;;MAEA;MACA;IACA;IAEA;IACAwC;MACApC;QACAqC;QACAC;QACAC;MACA;IACA;IAEA;IACAC;MACA5C;MACA;MACA;MACA;IACA;IAEA;IACA6C;MACA;MACA7C;IACA;IAEA;IACA8C;MACA9C;;MAEA;MACA;;MAEA;MACAI;QACAqC;QACAC;QACAC;MACA;;MAEA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACxpBA;AAAA;AAAA;AAAA;AAAy7C,CAAgB,k3CAAG,EAAC,C;;;;;;;;;;;ACA78C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/login/login.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/login/login.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./login.vue?vue&type=template&id=b237504c&scoped=true&\"\nvar renderjs\nimport script from \"./login.vue?vue&type=script&lang=js&\"\nexport * from \"./login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./login.vue?vue&type=style&index=0&id=b237504c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b237504c\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/login/login.vue\"\nexport default component.exports","export * from \"-!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./login.vue?vue&type=template&id=b237504c&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      $event.stopPropagation()\n      _vm.isXieyi = !_vm.isXieyi\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./login.vue?vue&type=script&lang=js&\"","<template>\r\n\t<!-- <view class=\"content\">\r\n\t\t<van-toast id=\"van-toast\" />\r\n\t\t<van-dialog id=\"van-dialog\" />\r\n\t</view> -->\r\n\t<view class=\"content reg-page\">\r\n\t\t<view class=\"reg-title\">登录</view>\r\n\t\t<view class=\"form-area\">\r\n\t\t\t<image :src=\"$imgUrl + 'logo.jpg'\"></image>\r\n\t\t\t<view class=\"operate-btn reg-page-btn\">\r\n\t\t\t\t<button type=\"primary\" class=\"round bg-my-blue\" open-type=\"getPhoneNumber\"\r\n\t\t\t\t\t@getphonenumber=\"onGetPhoneNumber\" v-if=\"isGetMobile\"\r\n\t\t\t\t\t:disabled=\"submitToggle\" :loading=\"submitToggle\">\r\n\t\t\t\t\t{{ submitToggle ? '登录中...' : '一键登录' }}\r\n\t\t\t\t</button>\r\n\t\t\t\t<button type=\"primary\" class=\"round bg-my-blue\" v-else :disabled=\"submitToggle\"\r\n\t\t\t\t\t:loading=\"submitToggle\" @click=\"login()\">\r\n\t\t\t\t\t{{ submitToggle ? '登录中...' : '一键登录' }}\r\n\t\t\t\t</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"flex-aic-jcc-wrap reset\" @click=\"handleOpenPrivacyContract()\">\r\n\t\t\t<label class=\"flex-aic\" @click.stop=\"isXieyi = !isXieyi\">\r\n\t\t\t\t<checkbox :checked=\"isXieyi\" />\r\n\t\t\t</label>\r\n\t\t\t<text>我已经详细阅读并同意</text>\r\n\t\t\t<text class=\"text-my-blue\" @click=\"handleOpenPrivacyContract()\">《隐私政策》</text>\r\n\t\t</view>\r\n\t\t<van-toast id=\"van-toast\" />\r\n\t\t<van-dialog id=\"van-dialog\" />\r\n\r\n\t\t<!-- 关注公众号弹窗 -->\r\n\t\t<view v-if=\"showFollowGuide\" class=\"popup-overlay\" @tap=\"onOverlayTap\">\r\n\t\t\t<view class=\"follow-guide-popup\" @tap.stop>\r\n\t\t\t\t<view class=\"popup-header\">\r\n\t\t\t\t\t<text class=\"popup-title\">请先关注公众号</text>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"qr-container\">\r\n\t\t\t\t\t<image\r\n\t\t\t\t\t\t:src=\"qrCodeUrl\"\r\n\t\t\t\t\t\tclass=\"qr-code\"\r\n\t\t\t\t\t\tmode=\"aspectFit\"\r\n\t\t\t\t\t\tshow-menu-by-longpress=\"true\"\r\n\t\t\t\t\t\t@tap=\"onTapQR\">\r\n\t\t\t\t\t</image>\r\n\t\t\t\t\t<text class=\"qr-tip\">长按识别二维码关注公众号</text>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"account-name\" v-if=\"accountName\">\r\n\t\t\t\t\t<text class=\"account-title\">公众号名称：</text>\r\n\t\t\t\t\t<text class=\"account-value\">{{ accountName }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport Toast from '../../wxcomponents/vant/toast/toast';\r\n\timport Dialog from '../../wxcomponents/vant/dialog/dialog';\r\n\timport {\r\n\t\tConfig\r\n\t} from \"../../common/Config.js\"\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\toplist:'',\r\n\t\t\t\t$imgUrl: Config.imgUrl,\r\n\t\t\t\tsubmitToggle: false,\r\n\t\t\t\tisXieyi: false,\r\n\t\t\t\tisGetMobile: true,\r\n\t\t\t\tloginCode: \"\",\r\n\t\t\t\tshowFollowGuide: false, // 是否显示关注公众号弹窗\r\n\t\t\t\tqrCodeUrl: '', // 公众号二维码URL\r\n\t\t\t\taccountName: '', // 公众号名称\r\n\t\t\t\tdebugReason: '', // 调试用的reason参数\r\n\t\t\t\toption: null // 页面参数\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\t// 保存页面参数\r\n\t\t\tthis.option = options;\r\n\r\n\t\t\t// 处理扫码参数\r\n\t\t\tif(options){\r\n\t\t\t\t// 如果有q参数（扫码链接）\r\n\t\t\t\tif(options.q) {\r\n\t\t\t\t\tthis.oplist = decodeURIComponent(options.q);\r\n\t\t\t\t}\r\n\t\t\t\t// 如果直接传入device和port参数（优先处理，不管是否有reason参数）\r\n\t\t\t\telse if(options.device && options.port) {\r\n\t\t\t\t\t// 构造与oplist相同格式的字符串，便于后续处理\r\n\t\t\t\t\tthis.oplist = `${Config.baseUrl}/ap3200/${options.device}/${options.port}`;\r\n\t\t\t\t}\r\n\t\t\t\t// 检查App全局参数\r\n\t\t\t\telse {\r\n\t\t\t\t\tconst app = getApp();\r\n\t\t\t\t\tif(app && app.globalData && app.globalData.scanParams) {\r\n\t\t\t\t\t\tconst scanParams = app.globalData.scanParams;\r\n\t\t\t\t\t\tif(scanParams.device && scanParams.port) {\r\n\t\t\t\t\t\t\tthis.oplist = `${Config.baseUrl}/ap3200/${scanParams.device}/${scanParams.port}`;\r\n\t\t\t\t\t\t\t// 清除全局参数，防止重复使用\r\n\t\t\t\t\t\t\tapp.globalData.scanParams = null;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.oplist = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.oplist = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.oplist = '';\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log('Login页面最终获取到的扫码参数:', this.oplist);\r\n\r\n\t\t\tthis.isGetMobile = !uni.getStorageSync(\"JeepGetPhone\");\r\n\t\t\tthis.getLoginCode();\r\n\r\n\t\t\t// 检查是否是从App.vue跳转过来需要处理特殊情况\r\n\t\t\tif (options && options.reason) {\r\n\t\t\t\tthis.debugReason = options.reason; // 设置调试信息\r\n\t\t\t\tconsole.log('检测到reason参数:', options.reason);\r\n\t\t\t\tif (options.reason === 'phone_auth') {\r\n\t\t\t\t\tconsole.log('需要重新进行手机号授权，当前oplist:', this.oplist);\r\n\t\t\t\t\t// 延迟执行，确保页面完全加载\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.triggerPhoneAuth();\r\n\t\t\t\t\t}, 500);\r\n\t\t\t\t} else if (options.reason === 'follow_wechat') {\r\n\t\t\t\t\tconsole.log('需要关注公众号，当前oplist:', this.oplist);\r\n\t\t\t\t\t// 这种情况通常会在后续的登录过程中自动处理\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgetLoginCode() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tuni.login({\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tthat.loginCode = res.code\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\thandleOpenPrivacyContract() {\r\n\t\t\t\tthis.isXieyi = true\r\n\t\t\t\tuni.openPrivacyContract({})\r\n\t\t\t},\r\n\t\t\tlogin() {\r\n\t\t\t\tif (!this.isXieyi) {\r\n\t\t\t\t\treturn this.$toast.fail(\"请先阅读协议\")\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 防止重复点击\r\n\t\t\t\tif (this.submitToggle) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\tcode: this.loginCode,\r\n\t\t\t\t}\r\n\t\t\t\tthis.doLogin(data)\r\n\t\t\t},\r\n\t\t\tonGetPhoneNumber(e) {\r\n\t\t\t\tif (!this.isXieyi) {\r\n\t\t\t\t\treturn this.$toast.fail(\"请先阅读协议\")\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 防止重复点击\r\n\t\t\t\tif (this.submitToggle) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 检查是否获取到手机号授权\r\n\t\t\t\tif (e.detail.errMsg !== 'getPhoneNumber:ok') {\r\n\t\t\t\t\treturn this.$toast.fail(\"获取手机号失败，请重试\")\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\tcode: this.loginCode,\r\n\t\t\t\t\tmcode: e.detail.code\r\n\t\t\t\t}\r\n\t\t\t\tthis.doLogin(data)\r\n\t\t\t},\r\n\t\t\tdoLogin(data) {\r\n\t\t\t\t// 设置加载状态，防止重复点击\r\n\t\t\t\tthis.submitToggle = true;\r\n\t\t\t\tconsole.log('开始登录，设置加载状态');\r\n\r\n\t\t\t\t// 提取设备ID参数\r\n\t\t\t\tlet deviceId = '';\r\n\r\n\t\t\t\t// 如果有扫码参数，尝试提取设备ID\r\n\t\t\t\tif(this.oplist && this.oplist !== 'undefined') {\r\n\t\t\t\t\t// 尝试使用正则表达式提取设备ID\r\n\t\t\t\t\tconst regex = /\\/([A-Fa-f0-9]{8})\\/([A-Fa-f0-9]{2})(?:\\/|$)/;\r\n\t\t\t\t\tconst match = this.oplist.match(regex);\r\n\r\n\t\t\t\t\tif (match && match.length >= 3) {\r\n\t\t\t\t\t\t// 使用正则表达式匹配结果\r\n\t\t\t\t\t\tdeviceId = match[1];\r\n\t\t\t\t\t\tconsole.log('从扫码参数提取设备ID:', deviceId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 使用原来的字符串截取方法\r\n\t\t\t\t\t\tdeviceId = this.oplist.substring(this.oplist.length-11, this.oplist.length-3);\r\n\t\t\t\t\t\tconsole.log('从字符串截取提取设备ID:', deviceId);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 注释：设备ID已经在onLoad时从URL参数提取并构造到oplist中，不需要再从全局数据获取\r\n\r\n\t\t\t\t// 将设备ID添加到登录参数中（只有存在时才添加）\r\n\t\t\t\tif(deviceId) {\r\n\t\t\t\t\tdata.deviceId = deviceId;\r\n\t\t\t\t\tconsole.log('添加设备ID到登录参数:', deviceId);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('没有设备ID，不添加到登录参数');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log('登录参数:', data);\r\n\r\n\t\t\t\t// 调用登录接口\r\n\t\t\t\tthis.$base.request('wxlogin/applet', 'POST', data)\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tres = res.data || {}\r\n\t\t\t\t\t\tif (res.code == 200) {\r\n\t\t\t\t\t\t\tconsole.log('登录成功:', res.data)\r\n\t\t\t\t\t\t\tuni.setStorageSync('user', res.data)\r\n\t\t\t\t\t\t\tuni.setStorageSync('userId', res.data.id);\r\n\t\t\t\t\t\t\tuni.setStorageSync('userToken', res.data.token)\r\n\t\t\t\t\t\t\tuni.setStorageSync('phone', res.data.phone)\r\n\t\t\t\t\t\t\tuni.setStorageSync('Name', res.data.realName)\r\n\t\t\t\t\t\t\tuni.setStorageSync('poster', res.data.poster)\r\n\t\t\t\t\t\t\tuni.setStorageSync('adunit', res.data.adunit)\r\n\t\t\t\t\t\t\tvar logolist = \"logolist_\" + uni.getStorageSync(\"userId\")\r\n\t\t\t\t\t\t\tuni.setStorageSync(logolist, \"\")\r\n\t\t\t\t\t\t\tvar usertype = 'type_' + uni.getStorageSync('userId')\r\n\t\t\t\t\t\t\tuni.setStorageSync(usertype, res.data.scan)\r\n\t\t\t\t\t\t\tif (res.data.posterList) {\r\n\t\t\t\t\t\t\t\tvar posterList = res.data.posterList\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < posterList.length; i++) {\r\n\t\t\t\t\t\t\t\t\tposterList[i].img = Config.imgapi + posterList[i].img\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tuni.setStorageSync('posterList', posterList)\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar posterList = []\r\n\t\t\t\t\t\t\t\tuni.setStorageSync('posterList', posterList)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// 获取配置信息\r\n\t\t\t\t\t\t\tthis.getConfig()\r\n\t\t\t\t\t\t\tthis.guangao()\r\n\t\t\t\t\t\t\tthis.logoshow()\r\n\t\t\t\t\t\t} else if (res.code == 599) {\r\n\t\t\t\t\t\t\tconsole.log('用户未关注公众号，显示关注引导');\r\n\t\t\t\t\t\t\t// 重置加载状态\r\n\t\t\t\t\t\t\tthis.submitToggle = false;\r\n\t\t\t\t\t\t\t// 显示关注公众号弹窗，传入完整的响应数据\r\n\t\t\t\t\t\t\tthis.showFollowGuidePopup(res);\r\n\t\t\t\t\t\t} else if (res.code == 598) {\r\n\t\t\t\t\t\t\tconsole.log('需要重新获取手机号授权');\r\n\t\t\t\t\t\t\t// 重置加载状态\r\n\t\t\t\t\t\t\tthis.submitToggle = false;\r\n\t\t\t\t\t\t\t// 重新获取登录code\r\n\t\t\t\t\t\t\tthis.getLoginCode();\r\n\t\t\t\t\t\t\t// 强制拉起手机号授权\r\n\t\t\t\t\t\t\tthis.triggerPhoneAuth();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log('登录失败:', res.msg);\r\n\t\t\t\t\t\t\t// 登录失败，重置状态\r\n\t\t\t\t\t\t\tthis.submitToggle = false;\r\n\t\t\t\t\t\t\tthis.getLoginCode()\r\n\t\t\t\t\t\t\tthis.$toast.fail(res.msg)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\tconsole.error('登录请求失败:', err);\r\n\t\t\t\t\t\t// 请求失败，重置状态\r\n\t\t\t\t\t\tthis.submitToggle = false;\r\n\t\t\t\t\t\tthis.$toast.fail('登录失败，请重试')\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tlogoshow() {\r\n\t\t\t\tconst userToken = uni.getStorageSync('userToken');\r\n\t\t\t\tif (!userToken) {\r\n\t\t\t\t\t// 如果没有token，重置加载状态\r\n\t\t\t\t\tthis.submitToggle = false;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet _this = this\r\n\t\t\t\tvar logolist = 'logolist_' + uni.getStorageSync('userId')\r\n\t\t\t\tuni.removeStorageSync(logolist)\r\n\t\t\t\t_this.$base.request('wechat/phone', 'GET')\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tif (res.data.code == 200) {\r\n\t\t\t\t\t\t\tvar list = res.data.data\r\n\t\t\t\t\t\t\tif (list.logo) {\r\n\t\t\t\t\t\t\t\tlist.logo = this.$imgUrl + list.logo.replace(\"/tabBarimg\", \"\")\r\n\t\t\t\t\t\t\t\tlist.loshow = 1\r\n\t\t\t\t\t\t\t\tuni.setStorageSync(logolist, list)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t_this.$toast.fail(res.data.msg)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 完成所有登录后续处理，执行跳转\r\n\t\t\t\t\t\tthis.loginOk()\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\tconsole.error('获取logo失败:', err)\r\n\t\t\t\t\t\t// 即使获取logo失败，也要执行跳转\r\n\t\t\t\t\t\tthis.loginOk()\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tloginOk() {\r\n\t\t\t\tconsole.log('登录完成，准备跳转页面');\r\n\r\n\t\t\t\t// 重置加载状态\r\n\t\t\t\tthis.submitToggle = false;\r\n\r\n\t\t\t\t// 处理扫码参数并跳转到充电页面\r\n\t\t\t\tif(this.oplist && this.oplist !== 'undefined'){\r\n\t\t\t\t\tconsole.log('处理扫码参数并跳转:', this.oplist);\r\n\r\n\t\t\t\t\t// 尝试使用正则表达式提取设备ID和端口号\r\n\t\t\t\t\tconst regex = /\\/([A-Fa-f0-9]{8})\\/([A-Fa-f0-9]{2})(?:\\/|$)/;\r\n\t\t\t\t\tconst match = this.oplist.match(regex);\r\n\r\n\t\t\t\t\tlet device = '';\r\n\t\t\t\t\tlet port = '';\r\n\r\n\t\t\t\t\tif (match && match.length >= 3) {\r\n\t\t\t\t\t\t// 使用正则表达式匹配结果\r\n\t\t\t\t\t\tdevice = match[1];\r\n\t\t\t\t\t\tport = match[2];\r\n\t\t\t\t\t\tconsole.log('正则匹配结果:', device, port);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 使用原来的字符串截取方法\r\n\t\t\t\t\t\tdevice = this.oplist.substring(this.oplist.length-11, this.oplist.length-3);\r\n\t\t\t\t\t\tport = this.oplist.substring(this.oplist.length-2, this.oplist.length);\r\n\t\t\t\t\t\tconsole.log('字符串截取结果:', device, port);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 处理端口号\r\n\t\t\t\t\tlet processedPort = '';\r\n\t\t\t\t\tif (port.toUpperCase() !== 'FF') {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tprocessedPort = this.pad(parseInt(port, 16).toString(10), 2);\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\tconsole.error('端口号转换错误:', e);\r\n\t\t\t\t\t\t\tprocessedPort = port;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tprocessedPort = port;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 确保有有效的设备ID和端口号\r\n\t\t\t\t\tif (device && processedPort) {\r\n\t\t\t\t\t\tconsole.log('登录成功，跳转到充电页面:', device, processedPort);\r\n\r\n\t\t\t\t\t\t// 检查是否是从扫码登录进入的\r\n\t\t\t\t\t\tconst returnType = this.option && this.option.returnType;\r\n\t\t\t\t\t\tif (returnType === 'charge') {\r\n\t\t\t\t\t\t\tconsole.log('从扫码登录进入，先跳转到首页再跳转到充电页面');\r\n\t\t\t\t\t\t\t// 先跳转到首页，确保tabBar可用，然后再跳转到充电页面\r\n\t\t\t\t\t\t\tuni.reLaunch({\r\n\t\t\t\t\t\t\t\turl: '/pages/index/index',\r\n\t\t\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\t\t\tconsole.log('先跳转到首页成功');\r\n\t\t\t\t\t\t\t\t\t// 延迟跳转到充电页面\r\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\t\t\t\t\turl: '/pageone/poweron/poweron?device=' + device + '&port=' + processedPort +\r\n\t\t\t\t\t\t\t\t\t\t\t\t'&cmd=0&from=1',\r\n\t\t\t\t\t\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('登录后跳转到充电页面成功');\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.error('跳转到充电页面失败:', err);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}, 100);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\t\t\tconsole.error('跳转到首页失败:', err);\r\n\t\t\t\t\t\t\t\t\t// 如果reLaunch失败，直接跳转到充电页面\r\n\t\t\t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\t\t\t\t\turl: '/pageone/poweron/poweron?device=' + device + '&port=' + processedPort +\r\n\t\t\t\t\t\t\t\t\t\t\t'&cmd=0&from=1'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log('从充电页面登录，返回到原页面');\r\n\t\t\t\t\t\t\t// 使用navigateBack返回到原页面，原页面会自动刷新数据\r\n\t\t\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\t\t\tdelta: 1,\r\n\t\t\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\t\t\tconsole.log('成功返回到充电页面');\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\t\t\tconsole.error('返回失败，使用redirectTo跳转:', err);\r\n\t\t\t\t\t\t\t\t\t// 如果返回失败，则使用redirectTo跳转\r\n\t\t\t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\t\t\t\t\turl: '/pageone/poweron/poweron?device=' + device + '&port=' + processedPort +\r\n\t\t\t\t\t\t\t\t\t\t\t'&cmd=0&from=1',\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn; // 已经跳转，不执行后续代码\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 如果没有扫码参数或参数无效，则使用之前的页面路径\r\n\t\t\t\tlet PrevLoginPath = uni.getStorageSync(\"PrevLoginPath\");\r\n\t\t\t\tconsole.log('使用之前的页面路径:', PrevLoginPath);\r\n\r\n\t\t\t\t// 处理特殊页面的跳转\r\n\t\t\t\tif (!PrevLoginPath || PrevLoginPath.indexOf(\"pages/index/index\") >= 0) {\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: \"/pages/index/index\"\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (PrevLoginPath && PrevLoginPath.indexOf(\"pages/smcharging/smcharging\") >= 0) {\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: \"/pages/smcharging/smcharging\"\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!PrevLoginPath || PrevLoginPath.indexOf(\"pages/chargingzhong/chargingzhong\") >= 0) {\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: \"/pages/chargingzhong/chargingzhong\"\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 如果是其他页面，直接跳转\r\n\t\t\t\tif (PrevLoginPath) {\r\n\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\turl: PrevLoginPath\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 默认跳转到首页\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: \"/pages/smcharging/smcharging\"\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// show(){\r\n\t\t\t// \tuni.login({\r\n\t\t\t// \t\tprovider:'weixin',\r\n\t\t\t// \t\tonlyAuthorize:true,\r\n\t\t\t// \t\tsuccess: res1=>{\r\n\t\t\t// \t\t\tvar appid=uni.getAccountInfoSync().miniProgram.appId\r\n\t\t\t// \t\t\tlet data = {\r\n\t\t\t// \t\t\t\tappid: appid,\r\n\t\t\t// \t\t\t\tcode: res1.code\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t\tthis.$base.request('wxlogin/minicallback', 'POST', data)\r\n\t\t\t// \t\t\t\t.then(res => {\r\n\t\t\t// \t\t\t\t\tif (res.data.code == '200') {\r\n\t\t\t// \t\t\t\t\t\tuni.setStorageSync('user', res.data.data)\r\n\t\t\t// \t\t\t\t\t\tuni.setStorageSync('userId', res.data.data.id);\r\n\t\t\t// \t\t\t\t\t\tuni.setStorageSync('userToken', res.data.data.token)\r\n\t\t\t// \t\t\t\t\t\tuni.setStorageSync('phone', res.data.data.phone)\r\n\t\t\t// \t\t\t\t\t\tuni.setStorageSync('Name', res.data.data.realName)\r\n\t\t\t// \t\t\t\t\t\tuni.setStorageSync('poster', res.data.data.poster)\r\n\t\t\t// \t\t\t\t\t\tuni.setStorageSync('adunit', res.data.data.adunit)\r\n\t\t\t// \t\t\t\t\t\tvar logolist = \"logolist_\" + uni.getStorageSync(\"userId\")\r\n\t\t\t// \t\t\t\t\t\tuni.setStorageSync(logolist, \"\")\r\n\t\t\t// \t\t\t\t\t\tvar usertype = 'type_' + uni.getStorageSync('userId')\r\n\t\t\t// \t\t\t\t\t\tuni.setStorageSync(usertype, res.data.data.scan)\r\n\t\t\t// \t\t\t\t\t\tif (res.data.data.posterList) {\r\n\t\t\t// \t\t\t\t\t\t\tvar posterList = res.data.data.posterList\r\n\t\t\t// \t\t\t\t\t\t\tfor (var i = 0; i < posterList.length; i++) {\r\n\t\t\t// \t\t\t\t\t\t\t\tposterList[i].img = Config.imgapi + posterList[i].img\r\n\t\t\t// \t\t\t\t\t\t\t}\r\n\t\t\t// \t\t\t\t\t\t\tuni.setStorageSync('posterList', posterList)\r\n\t\t\t// \t\t\t\t\t\t} else {\r\n\t\t\t// \t\t\t\t\t\t\tvar posterList = []\r\n\t\t\t// \t\t\t\t\t\t\tuni.setStorageSync('posterList', posterList)\r\n\t\t\t// \t\t\t\t\t\t}\r\n\t\t\t// \t\t\t\t\t\tthis.getConfig()\r\n\t\t\t// \t\t\t\t\t\tthis.guangao()\r\n\t\t\t// \t\t\t\t\t\tvar _this = this\r\n\t\t\t// \t\t\t\t\t\tif(_this.oplist!='undefined'){\r\n\t\t\t// \t\t\t\t\t\t\tvar device=_this.oplist.substring(_this.oplist.length-11,_this.oplist.length-3);\r\n\t\t\t// \t\t\t\t\t\t\tvar port =_this.oplist.substring(_this.oplist.length-2,_this.oplist.length);\r\n\t\t\t// \t\t\t\t\t\t\tlet ss = '';\r\n\t\t\t// \t\t\t\t\t\t\tif (port != 'ff' && port != 'FF') {\r\n\t\t\t// \t\t\t\t\t\t\t\tss=_this.pad(parseInt(port,16).toString(10),2);\r\n\t\t\t// \t\t\t\t\t\t\t} else {\r\n\t\t\t// \t\t\t\t\t\t\t\tss = port;\r\n\t\t\t// \t\t\t\t\t\t\t};\r\n\t\t\t// \t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t// \t\t\t\t\t\t\t\turl:'/pageone/poweron/poweron?device=' + device + '&port=' + ss +\r\n\t\t\t// \t\t\t\t\t\t\t\t\t'&cmd=' + 0 + '&from=' + 1,\r\n\t\t\t// \t\t\t\t\t\t\t});\r\n\t\t\t// \t\t\t\t\t\t}else{\r\n\t\t\t// \t\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t// \t\t\t\t\t\t\t\turl: '../smcharging/smcharging'\r\n\t\t\t// \t\t\t\t\t\t\t})\r\n\t\t\t// \t\t\t\t\t\t}\r\n\r\n\t\t\t// \t\t\t\t\t} else {\r\n\t\t\t// \t\t\t\t\t\tToast.fail(res.data.msg)\r\n\t\t\t// \t\t\t\t\t}\r\n\t\t\t// \t\t\t\t}).catch(err => {\r\n\r\n\t\t\t// \t\t\t\t})\r\n\t\t\t// \t\t}\r\n\t\t\t// \t})\r\n\r\n\t\t\t// },\r\n\t\t\tpad(num, n) {\r\n\t\t\t\tvar len = num.toString().length;\r\n\t\t\t\twhile (len < n) {\r\n\t\t\t\t\tnum = \"0\" + num;\r\n\t\t\t\t\tlen++;\r\n\t\t\t\t}\r\n\t\t\t\treturn num;\r\n\t\t\t},\r\n\t\t\tmbid(){\r\n\t\t\t\tlet moban=new Object();\r\n\t\t\t\tvar appid=uni.getAccountInfoSync().miniProgram.appId\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\tappid: appid,\r\n\t\t\t\t}\r\n\t\t\t\tthis.$base.request('wechat/template', 'GET', data)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tif (res.data.code == '200') {\r\n\t\t\t\t\t\tvar arr=res.data.data\r\n\t\t\t\t\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\t\t\t\t\tif(arr[i].types==1){\r\n\t\t\t\t\t\t\t\tmoban.kaishi=arr[i].templateCode\r\n\t\t\t\t\t\t\t}else if(arr[i].types==2){\r\n\t\t\t\t\t\t\t\tmoban.wancheng=arr[i].templateCode\r\n\t\t\t\t\t\t\t}else if(arr[i].types==3){\r\n\t\t\t\t\t\t\t\tmoban.yichang=arr[i].templateCode\r\n\t\t\t\t\t\t\t}else if(arr[i].types==7){\r\n\t\t\t\t\t\t\t\tmoban.chongzhi=arr[i].templateCode\r\n\t\t\t\t\t\t\t}else if(arr[i].types==8){\r\n\t\t\t\t\t\t\t\tmoban.tuikuan=arr[i].templateCode\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tuni.setStorageSync('moban', moban)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tToast.fail(res.data.msg)\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(err => {\r\n\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//获取商业化个人屏蔽配置\r\n\t\t\tgetConfig(){\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\ttoken: uni.getStorageSync(\"userToken\"),\r\n\t\t\t\t};\r\n\t\t\t\tthis.$base.request(\"com/getConfig\", \"GET\", data).then((res) => {\r\n\t\t\t\t\tif (res.data.code == \"200\") {\r\n\t\t\t\t\t\tuni.setStorageSync(\"reassuring\", res.data.data.reassuring);\r\n\t\t\t\t\t\tuni.setStorageSync(\"postervip\", res.data.data.poster);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t// this.$toast.fail(res.data.msg)\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch((err) => {\r\n\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//获取广告配置\r\n\t\t\tguangao(){\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\tprojectId: uni.getStorageSync(\"user\").projectId,\r\n\t\t\t\t};\r\n\t\t\t\tthis.$base.request(\"poster/getPosterConfig\", \"POST\", data).then((res) => {\r\n\t\t\t\t\tif (res.data.code == \"200\") {\r\n\t\t\t\t\t\tuni.setStorageSync(\"point\", res.data.data);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tuni.setStorageSync(\"point\", 0);\r\n\t\t\t\t\t\t// this.$toast.fail(res.data.msg)\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch((err) => {\r\n\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t// 显示关注公众号弹窗\r\n\t\t\tshowFollowGuidePopup(responseData) {\r\n\t\t\t\tconsole.log('显示关注公众号弹窗，完整响应数据:', responseData);\r\n\t\t\t\tconsole.log('当前showFollowGuide状态:', this.showFollowGuide);\r\n\r\n\t\t\t\t// 处理二维码URL - wechatImg在data下面\r\n\t\t\t\tif (responseData && responseData.data && responseData.data.wechatImg) {\r\n\t\t\t\t\tthis.qrCodeUrl = Config.imgapi + responseData.data.wechatImg;\r\n\t\t\t\t\tconsole.log('公众号二维码URL:', this.qrCodeUrl);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error('未获取到公众号二维码，responseData:', responseData);\r\n\t\t\t\t\tthis.$toast.fail('获取公众号信息失败');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 处理公众号名称 - wechatName和code同级\r\n\t\t\t\tif (responseData && responseData.wechatName) {\r\n\t\t\t\t\tthis.accountName = responseData.wechatName;\r\n\t\t\t\t\tconsole.log('公众号名称:', this.accountName);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('未获取到公众号名称，responseData:', responseData);\r\n\t\t\t\t\tthis.accountName = '';\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 显示弹窗\r\n\t\t\t\tthis.showFollowGuide = true;\r\n\t\t\t\tconsole.log('设置showFollowGuide为true，当前值:', this.showFollowGuide);\r\n\r\n\t\t\t\t// 强制更新视图\r\n\t\t\t\tthis.$forceUpdate();\r\n\t\t\t},\r\n\r\n\t\t\t// 点击二维码提示\r\n\t\t\tonTapQR() {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '请长按识别二维码关注',\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 2000\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t// 关闭关注引导弹窗（仅用于内部清理，用户无法主动关闭）\r\n\t\t\tcloseFollowGuide() {\r\n\t\t\t\tconsole.log('清理关注公众号弹窗数据');\r\n\t\t\t\tthis.showFollowGuide = false;\r\n\t\t\t\tthis.qrCodeUrl = '';\r\n\t\t\t\tthis.accountName = '';\r\n\t\t\t},\r\n\r\n\t\t\t// 遮罩层点击处理（暂时不允许点击遮罩关闭）\r\n\t\t\tonOverlayTap() {\r\n\t\t\t\t// 不做任何操作，防止点击遮罩关闭弹窗\r\n\t\t\t\tconsole.log('点击了遮罩层，但不关闭弹窗');\r\n\t\t\t},\r\n\r\n\t\t\t// 强制拉起手机号授权\r\n\t\t\ttriggerPhoneAuth() {\r\n\t\t\t\tconsole.log('强制拉起手机号授权');\r\n\r\n\t\t\t\t// 设置需要手机号授权状态\r\n\t\t\t\tthis.isGetMobile = true;\r\n\r\n\t\t\t\t// 显示简单提示信息\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '需要重新授权手机号',\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 2000\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// 强制更新视图，确保显示手机号授权按钮\r\n\t\t\t\tthis.$forceUpdate();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.icon {\r\n\t\tfont-size: 38rpx;\r\n\t}\r\n\r\n\t.content.reg-page {\r\n\t\tbox-sizing: border-box;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tflex: 1;\r\n\t\twidth: 100%;\r\n\t\theight: 100vh;\r\n\t\tpadding: 30rpx 86rpx;\r\n\t\tposition: relative;\r\n\t\tz-index: 9;\r\n\t\tbackground-color: #242225;\r\n\t\ttext-align: center;\r\n\r\n\t\timage {\r\n\t\t\twidth: 320rpx;\r\n\t\t\theight: 320rpx;\r\n\t\t\tmargin-top: 13vh;\r\n\t\t}\r\n\t}\r\n\r\n\t.reg-title {\r\n\t\tfont-size: 50rpx;\r\n\t\tmargin: 110rpx 0 90rpx;\r\n\t\tcolor: #fff;\r\n\t}\r\n\r\n\t.reg-page-btn {\r\n\t\tmargin-top: 100rpx;\r\n\t}\r\n\r\n\t.go-login {\r\n\t\tcolor: #7E8388;\r\n\t\tfont-size: 26rpx;\r\n\t\ttext-align: right;\r\n\t}\r\n\r\n\t.operate-btn button {\r\n\t\tfont-size: 32rpx;\r\n\t\theight: 80rpx;\r\n\t\tline-height: 80rpx;\r\n\t\tbackground: linear-gradient(180deg, #FFA73E 0%, #FF752B 100%);\r\n\t}\r\n\r\n\r\n\t.reset {\r\n\t\tcolor: #666;\r\n\t\tfont-size: 22rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-top: 60rpx;\r\n\t\twhite-space: nowrap;\r\n\r\n\t\tcheckbox {\r\n\t\t\ttransform: scale(.6);\r\n\t\t}\r\n\r\n\t\t.line {\r\n\t\t\tmargin: 0 2em;\r\n\t\t}\r\n\r\n\t\t.text-my-blue {\r\n\t\t\tcolor: #FF752B;\r\n\t\t}\r\n\t}\r\n\t/* .content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.logo {\r\n\t\theight: 200rpx;\r\n\t\twidth: 200rpx;\r\n\t\tmargin-top: 200rpx;\r\n\t\tmargin-left: auto;\r\n\t\tmargin-right: auto;\r\n\t\tmargin-bottom: 50rpx;\r\n\t}\r\n\r\n\t.text-area {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.title {\r\n\t\tfont-size: 36rpx;\r\n\t\tcolor: #8f8f94;\r\n\t} */\r\n\r\n\t/* 关注公众号弹窗样式 */\r\n\t.popup-overlay {\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground: rgba(0, 0, 0, 0.5);\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tz-index: 9999;\r\n\t}\r\n\r\n\t.follow-guide-popup {\r\n\t\twidth: 600rpx;\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 20rpx;\r\n\t\tpadding: 40rpx;\r\n\t\tbox-sizing: border-box;\r\n\t\ttext-align: center;\r\n\r\n\t\t.popup-header {\r\n\t\t\tmargin-bottom: 40rpx;\r\n\r\n\t\t\t.popup-title {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tfont-size: 36rpx;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.qr-container {\r\n\t\t\tmargin-bottom: 40rpx;\r\n\r\n\t\t\t.qr-code {\r\n\t\t\t\twidth: 300rpx;\r\n\t\t\t\theight: 300rpx;\r\n\t\t\t\tborder-radius: 20rpx;\r\n\t\t\t\tborder: 2rpx solid #eee;\r\n\t\t\t\tmargin-bottom: 20rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.qr-tip {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t\tline-height: 40rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.account-name {\r\n\t\t\tmargin-bottom: 30rpx;\r\n\t\t\tpadding: 20rpx;\r\n\t\t\tbackground: #f8f9fa;\r\n\t\t\tborder-radius: 10rpx;\r\n\t\t\ttext-align: center;\r\n\r\n\t\t\t.account-title {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t\tmargin-right: 10rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.account-value {\r\n\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t}\r\n</style>\r\n","import mod from \"-!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./login.vue?vue&type=style&index=0&id=b237504c&lang=scss&scoped=true&\"; export default mod; export * from \"-!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.4.24.2024072208\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./login.vue?vue&type=style&index=0&id=b237504c&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1749174615181\n      var cssReload = require(\"D:/软件/HBuilderX.4.24.2024072208/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}